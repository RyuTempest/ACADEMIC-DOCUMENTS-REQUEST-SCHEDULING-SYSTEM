## Academic Documents Request Scheduling System (ADRS)

A PHP/MySQL web application that allows users to schedule registrar appointments and request academic documents, while administrators manage available slots, monitor requests, and update document statuses.

### Key Features
- **Authentication**: Registration, login, forgot/reset password
- **Role-based access**: `user` and `admin`
- **Admin calendar and slots**: Create day slots with AM/PM capacities; FullCalendar integration
- **User booking**: Pick available date/slot, select document types, compute fees
- **Transactions**: Store payment method and application details
- **Notifications**: System designed for updates; optional SMS/email integration
- **Responsive UI**: Tailwind CSS and Bootstrap-based templates

### Tech Stack
- **Language**: PHP (mysqli)
- **Database**: MySQL/MariaDB
- **Frontend**: Bootstrap, Tailwind, FullCalendar, jQuery, SweetAlert2
- **Composer packages**:
  - `twilio/sdk` (optional SMS)
  - `google/apiclient` (optional future integrations)
  - `phpmailer/phpmailer` (email for password reset)

---

## Folder Structure
- `admin/`: Admin dashboard pages (calendar, appointments, documents, history)
- `auth/`: `register.php`, `forgot.password.php`, `reset.password.php`
- `user/`: User calendar and booking flow (`calendar.php`, `process.booking.php`, `payment.php`)
- `include/`: Shared files (e.g., `config.php` for DB connection)
- `database/`: SQL dump(s), e.g., `book (6).sql`
- `assets/`: CSS, JS, images, plugins
- `vendor/`: Composer dependencies (generated by `composer install`)
- `index.php`: Login page and entry point

---

## Prerequisites
- PHP 8.0+ (8.1+ recommended)
- MySQL 5.7+ / MariaDB 10.3+
- Composer
- Web server (Apache or Nginx). Apache with PHP module is the simplest path.

---

## Quick Start (Local)
1. Clone or copy the project into your web server root.
2. Install PHP dependencies:
   ```bash
   composer install
   ```
3. Create the database and import schema/data:
   - Create a database (e.g., `adrs`)
   - Import `database/book (6).sql` via phpMyAdmin or CLI:
     ```bash
     mysql -u <user> -p <database_name> < "database/book (6).sql"
     ```
4. Update database credentials in `include/config.php`:
   ```php
   <?php
   $servername = "localhost";
   $username = "your_db_user";
   $password = "your_db_password";
   $db = "your_db_name";
   $conn = new mysqli($servername, $username, $password, $db);
   if ($conn->connect_error) { die("Connection failed: " . $conn->connect_error); }
   ?>
   ```
5. Configure your virtual host/site to serve the project directory. Then open the site in a browser.

---

## Application Flows
### Authentication
- `index.php`: Login
- `auth/register.php`: User registration (validates TUPV ID format, email, mobile)
- `auth/forgot.password.php`: Sends password reset link via email using PHPMailer
- `auth/reset.password.php`: Receives token to reset password

### Admin
- `admin/calendar.php`: Create AM/PM slots for specific dates with capacities
- `admin/fetch.events.php`: Returns slot availability as FullCalendar events (JSON)
- Other pages: `pending/complete` appointments and documents, history, profile

### User
- `user/calendar.php`: View available slots on calendar; click to book
- `user/process.booking.php`: Validates availability, reserves slot, generates reference number, creates `bookings` and `documents` records in a transaction
- `user/payment.php`: Persists a `transactions` record with booking details (current flow is Over-the-Counter)

---

## Database Schema (Summary)
Imported from `database/book (6).sql`:
- `user` (id, firstname, middlename, lastname, email, cellphone, username, password, role, password_reset_token, ...)
- `user_submissions` (user profile details incl. course; linked to `user`)
- `slots` (per-date AM/PM capacities and booked counts; linked to `user` for admin owner)
- `bookings` (user bookings per slot with reference number and request metadata)
- `documents` (document items per booking with status)
- `transactions` (payment/application details per booking)
- `notifications` (messages for user/document)

Foreign keys are defined across `user`, `slots`, `bookings`, `documents`, and `transactions`.

---

## Configuration and Secrets
This repository currently stores credentials directly in files such as:
- `include/config.php` (database)
- `auth/forgot.password.php` (SMTP username and app password)

For security and portability, move secrets to environment variables or a `.env` file and load them in PHP. Example using environment variables:
```php
// include/config.php
$conn = new mysqli(
  getenv('DB_HOST') ?: 'localhost',
  getenv('DB_USER') ?: 'root',
  getenv('DB_PASS') ?: '',
  getenv('DB_NAME') ?: 'adrs'
);
```
If you prefer `.env`, add `vlucas/phpdotenv` and load variables early in your bootstrap (e.g., `index.php`). Do not commit `.env`.

PHPMailer SMTP configuration (recommended env vars):
```php
$smtpEmail = getenv('SMTP_USER');
$smtpPassword = getenv('SMTP_PASS');
```

Twilio SDK and Google API Client are included by Composer but optional. If you integrate SMS or Google APIs:
- Add and read `TWILIO_ACCOUNT_SID`, `TWILIO_AUTH_TOKEN`, `TWILIO_FROM`
- Add and read Google OAuth or service account credentials as needed

---

## Common URLs
- Login: `/index.php`
- Register: `/auth/register.php`
- Forgot Password: `/auth/forgot.password.php`
- Admin Calendar: `/admin/calendar.php`
- User Calendar: `/user/calendar.php`

---

## Developer Notes
- Strictly use prepared statements (already used throughout)
- Keep UI assets in `assets/`; avoid inline secrets in views
- JSON endpoints:
  - `admin/fetch.events.php` and `user/fetch.events.php` are consumed by FullCalendar
  - `user/process.booking.php` expects POST and returns JSON
- After changing schema, update the SQL dump in `database/`

---

## Deployment
1. Set up PHP 8.1+, MySQL, and a web server
2. Copy project files and run `composer install`
3. Set env variables or update `include/config.php`
4. Import `database/book (6).sql`
5. Point your virtual host to the project directory
6. Ensure `vendor/` is present on the server or run `composer install` there

For Apache, ensure PHP is enabled. Pretty URLs are not required.

---

## Troubleshooting
- White page or 500 error: check PHP error log and file permissions
- Cannot connect DB: verify `include/config.php` or env vars; confirm DB host reaches the database
- Emails not sending: ensure you use a Gmail App Password or a proper SMTP provider; check blocked ports on host
- Calendar not showing events: check JSON endpoints and browser console; verify `fetch.events.php` responses

---

## Security Checklist
- Remove hardcoded credentials from source control
- Use HTTPS in production
- Use strong, unique app passwords for SMTP
- Keep Composer dependencies up to date
- Validate and sanitize user inputs (already implemented in most forms)

---

## License
Specify your chosen license here (e.g., MIT). If omitted, all rights reserved by default.


